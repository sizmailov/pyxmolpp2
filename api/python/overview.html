<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Overview | xmolpp2 Python API</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,400i,600,600i%7CSource+Code+Pro:400,400i,600" />
  <link rel="stylesheet" href="m-dark+documentation.compiled.css" />
  <link rel="icon" href="favicon-dark.png" type="image/png" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#22272e" />
</head>
<body>
<header><nav id="navigation">
  <div class="m-container">
    <div class="m-row">
      <span id="m-navbar-brand" class="m-col-t-8 m-col-m-none m-left-m">
        <a href="../../">xmolpp2</a> <span class="m-breadcrumb">|</span> <a href="index.html" class="m-thin">Python API</a>
      </span>
      <div class="m-col-t-4 m-hide-m m-text-right m-nopadr">
        <a href="#search" class="m-doc-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
          <path id="m-doc-search-icon-path" d="m6 0c-3.31 0-6 2.69-6 6 0 3.31 2.69 6 6 6 1.49 0 2.85-0.541 3.89-1.44-0.0164 0.338 0.147 0.759 0.5 1.15l3.22 3.79c0.552 0.614 1.45 0.665 2 0.115 0.55-0.55 0.499-1.45-0.115-2l-3.79-3.22c-0.392-0.353-0.812-0.515-1.15-0.5 0.895-1.05 1.44-2.41 1.44-3.89 0-3.31-2.69-6-6-6zm0 1.56a4.44 4.44 0 0 1 4.44 4.44 4.44 4.44 0 0 1-4.44 4.44 4.44 4.44 0 0 1-4.44-4.44 4.44 4.44 0 0 1 4.44-4.44z"/>
        </svg></a>
        <a id="m-navbar-show" href="#navigation" title="Show navigation"></a>
        <a id="m-navbar-hide" href="#" title="Hide navigation"></a>
      </div>
      <div id="m-navbar-collapse" class="m-col-t-12 m-show-m m-col-m-none m-right-m">
        <div class="m-row">
          <ol class="m-col-t-12 m-col-m-none">
            <li>
              <a href="install.html">Install</a>
              <ol>
                <li><a href="changelog.html">Changelog</a></li>
              </ol>
            </li>
            <li>
              <a href="overview.html">Docs</a>
              <ol>
                <li><a href="overview.html">Overview</a></li>
                <li><a href="examples/index.html">Examples</a></li>
              </ol>
            </li>
            <li>
              <a href="pyxmolpp2.html">API</a>
              <ol>
                <li><a href="modules.html">Modules</a></li>
                <li><a href="classes.html">Classes</a></li>
              </ol>
            </li>
            <li><a href="https://github.com/sizmailov/pyxmolpp2">Github</a></li>
          </ol>
          <ol class="m-col-t-6 m-col-m-none" start="5">
            <li class="m-show-m"><a href="#search" class="m-doc-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
              <use href="#m-doc-search-icon-path" />
            </svg></a></li>
          </ol>
        </div>
      </div>
    </div>
  </div>
</nav></header>
<main><article>
  <div class="m-container m-container-inflatable">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <h1>
          Overview
        </h1>
<section id="basics">
<h2>Basics</h2>
<p>The <code>pyxmolpp2</code> library implements <a class="m-doc" href="pyxmolpp2.Frame.html">Frame</a>/<a class="m-doc" href="pyxmolpp2.Molecule.html">Molecule</a>/<a class="m-doc" href="pyxmolpp2.Residue.html">Residue</a>/<a class="m-doc" href="pyxmolpp2.Atom.html">Atom</a> hierarchy to represent a molecular frame.</p>
<p>Unlike many other molecular libraries <a class="m-doc" href="pyxmolpp2.Atom.html">Atom</a>, <a class="m-doc" href="pyxmolpp2.Residue.html">Residue</a> or <a class="m-doc" href="pyxmolpp2.Molecule.html">Molecule</a> instances do not exist in isolation, they are always part of <a class="m-doc" href="pyxmolpp2.Frame.html">Frame</a>.
Therefore any <a class="m-doc" href="pyxmolpp2.Atom.html">Atom</a>, <a class="m-doc" href="pyxmolpp2.Residue.html">Residue</a> or <a class="m-doc" href="pyxmolpp2.Molecule.html">Molecule</a> are guaranteed to have a parent.
This makes expression <code class="m-code"><span class="n">atom</span><span class="o">.</span><span class="n">residue</span><span class="o">.</span><span class="n">molecule</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">index</span></code> always valid and eliminates <code class="m-code"><span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span></code> checks from user and library code.</p>
<aside class="m-block m-danger">
<h3>Keep frame alive</h3>
<p><a class="m-doc" href="pyxmolpp2.Atom.html">Atom</a>/<a class="m-doc" href="pyxmolpp2.Residue.html">Residue</a>/<a class="m-doc" href="pyxmolpp2.Molecule.html">Molecule</a> are alive while the <a class="m-doc" href="pyxmolpp2.Frame.html">Frame</a> exists.
<a class="m-doc" href="pyxmolpp2.Frame.html">Frame</a> exists until python holds a reference to it. No frame - no game.</p>
</aside>
<aside class="m-block m-default">
<h3>Example</h3>
<p>Let's access first C-alpha atom of molecule <code>A</code>:</p>
<div class="m-code-figure">
<div class="m-py-exec">
<pre class="m-code"><span class="n">atom</span> <span class="o">=</span> <span class="n">frame</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;CA&quot;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">atom</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">atom</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">atom</span><span class="o">.</span><span class="n">r</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">atom</span><span class="o">.</span><span class="n">residue</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">atom</span><span class="o">.</span><span class="n">residue</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="n">atom</span><span class="o">.</span><span class="n">molecule</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
      <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="p">)</span></pre>
</div>
<div class="m-py-exec">
<pre class="m-code m-nopad m-console">2 CA [26.266000, 25.413000, 2.842000]
1 MET
A</pre>
</div>
</div>
<p>Let's intentionally destroy frame, by dropping the only reference and see what
happens when we try to access stored atom reference:</p>
<div class="m-code-figure">
<div class="m-py-exec">
<pre class="m-code"><span class="n">frame</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">atom</span><span class="o">.</span><span class="n">name</span></pre>
</div>
<div class="m-py-exec">
<pre class="m-code m-nopad m-console"><span class="g g-AnsiRed">Traceback (most recent call last):</span>
<span class="g g-AnsiRed">  File &quot;&lt;string&gt;&quot;, line 2, in &lt;module&gt;</span>
<span class="g g-AnsiRed">pyxmolpp2._core.DeadFrameAccessError: AtomSmartRef::name()</span></pre>
</div>
</div>
</aside>
<p>To ease manipulation with group of elements <code>pyxmolpp2</code> provides number of <em>selection</em> classes: <a class="m-doc" href="pyxmolpp2.CoordSelection.html">CoordSelection</a>, <a class="m-doc" href="pyxmolpp2.AtomSelection.html">AtomSelection</a>, <a class="m-doc" href="pyxmolpp2.ResidueSelection.html">ResidueSelection</a> and <a class="m-doc" href="pyxmolpp2.MoleculeSelection.html">MoleculeSelection</a>. Selections support mutual interconversion operations, generic set operations (union, intersection, difference), slicing, iteration and number of other handy methods.</p>
<p>Selections are <em>ordered</em> sets of elements, the order in selections matches order in parent frame.
Note, on mixing elements from two frames an exception will be raised, see an <a href="#mixing-frames-in-selection">example</a>.</p>
<aside class="m-block m-default">
<h3>Examples</h3>
<p>Count atoms, residues and molecules in frame</p>
<div class="m-code-figure">
<div class="m-py-exec">
<pre class="m-code"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s2">    Molecules: </span><span class="si">{</span><span class="n">frame</span><span class="o">.</span><span class="n">molecules</span><span class="o">.</span><span class="n">size</span><span class="si">}</span><span class="s2"></span>
<span class="s2">    Residues : </span><span class="si">{</span><span class="n">frame</span><span class="o">.</span><span class="n">residues</span><span class="o">.</span><span class="n">size</span><span class="si">}</span><span class="s2"></span>
<span class="s2">    Atoms    : </span><span class="si">{</span><span class="n">frame</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">size</span><span class="si">}</span><span class="s2"></span>
<span class="s2">    Coords   : </span><span class="si">{</span><span class="n">frame</span><span class="o">.</span><span class="n">coords</span><span class="o">.</span><span class="n">size</span><span class="si">}</span><span class="s2"> (always same as atoms.size)</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span></pre>
</div>
<div class="m-py-exec">
<pre class="m-code m-nopad m-console">    Molecules: 2
    Residues : 134
    Atoms    : 660
    Coords   : 660 (always same as atoms.size)</pre>
</div>
</div>
<p>Combine and convert selections:</p>
<div class="m-code-figure">
<div class="m-py-exec">
<pre class="m-code"><span class="n">first_two</span> <span class="o">=</span> <span class="n">frame</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">residues</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
<span class="n">last_two</span> <span class="o">=</span> <span class="n">frame</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">residues</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]</span>
<span class="n">four_termini</span> <span class="o">=</span> <span class="n">first_two</span> <span class="o">|</span> <span class="n">last_two</span>
<span class="n">all_ca</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">aName</span><span class="o">==</span><span class="s2">&quot;CA&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s2">    Atoms in two first residues : </span><span class="si">{</span><span class="n">first_two</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">size</span><span class="si">}</span><span class="s2"></span>
<span class="s2">    Atoms in two last residues  : </span><span class="si">{</span><span class="n">last_two</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">size</span><span class="si">}</span><span class="s2"></span>
<span class="s2">    Atoms in four residues      : </span><span class="si">{</span><span class="n">four_termini</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">size</span><span class="si">}</span><span class="s2"></span>
<span class="s2">    Number of &quot;CA&quot; atoms        : </span><span class="si">{</span><span class="n">all_ca</span><span class="o">.</span><span class="n">size</span><span class="si">}</span><span class="s2"></span>
<span class="s2">    Geom center of &quot;CA&quot; atoms   : </span><span class="si">{</span><span class="n">all_ca</span><span class="o">.</span><span class="n">coords</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">}</span><span class="s2"></span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span></pre>
</div>
<div class="m-py-exec">
<pre class="m-code m-nopad m-console">    Atoms in two first residues : 17
    Atoms in two last residues  : 9
    Atoms in four residues      : 26
    Number of &quot;CA&quot; atoms        : 76
    Geom center of &quot;CA&quot; atoms   : [30.442895, 29.008987, 15.516395]</pre>
</div>
</div>
<p id="mixing-frames-in-selection">Mixing elements from two or more frames is not allowed:</p>
<div class="m-code-figure">
<div class="m-py-exec">
<pre class="m-code"><span class="n">mixed_atom_selection</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">atoms</span> <span class="o">|</span> <span class="n">frame2</span><span class="o">.</span><span class="n">atoms</span></pre>
</div>
<div class="m-py-exec">
<pre class="m-code m-nopad m-console"><span class="g g-AnsiRed">Traceback (most recent call last):</span>
<span class="g g-AnsiRed">  File &quot;&lt;string&gt;&quot;, line 1, in &lt;module&gt;</span>
<span class="g g-AnsiRed">pyxmolpp2._core.MultipleFramesSelectionError: AtomSelection::operator|=()</span></pre>
</div>
</div>
</aside>
<section id="predicates">
<h3>Predicates</h3>
<p>Library provides predicate generators in order to simplify selection filtering. On comparison with value they produce
predicates which can be combined together to produce new one. Parent predicates can be naturally applied to selections of child elements, for example <a class="m-doc" href="pyxmolpp2.ResiduePredicate.html">ResiduePredicate</a> can be applied to filter <a class="m-doc" href="pyxmolpp2.AtomSelection.html">AtomSelection</a>.</p>
<div class="m-code-figure">
<div class="m-py-exec">
<pre class="m-code"><span class="kn">from</span> <span class="nn">pyxmolpp2</span> <span class="kn">import</span> <span class="n">aName</span><span class="p">,</span> <span class="n">rId</span><span class="p">,</span> <span class="n">rName</span><span class="p">,</span> <span class="n">aId</span><span class="p">,</span> <span class="n">mName</span>

<span class="k">for</span> <span class="n">predicate</span> <span class="ow">in</span> <span class="p">[</span>
    <span class="n">aName</span><span class="o">==</span><span class="s2">&quot;CA&quot;</span><span class="p">,</span>
    <span class="n">aId</span> <span class="o">==</span> <span class="mi">3</span><span class="p">,</span>
    <span class="c1"># combine AtomPredicate and ResiduePredicate:</span>
    <span class="p">(</span><span class="n">aName</span><span class="o">.</span><span class="n">is_in</span><span class="p">({</span><span class="s2">&quot;N&quot;</span><span class="p">,</span> <span class="s2">&quot;CA&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;O&quot;</span><span class="p">}))</span> <span class="o">&amp;</span> <span class="n">rId</span><span class="o">.</span><span class="n">is_in</span><span class="p">({</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">}),</span>
    <span class="n">rName</span><span class="o">==</span><span class="s2">&quot;GLY&quot;</span><span class="p">,</span>
<span class="p">]:</span>
    <span class="n">asel</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">predicate</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Selected </span><span class="si">{</span><span class="n">asel</span><span class="o">.</span><span class="n">size</span><span class="si">:</span><span class="s2">2d</span><span class="si">}</span><span class="s2"> atoms from &quot;</span>
          <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">asel</span><span class="o">.</span><span class="n">residues</span><span class="o">.</span><span class="n">size</span><span class="si">:</span><span class="s2">2d</span><span class="si">}</span><span class="s2"> residues&quot;</span>
          <span class="sa">f</span><span class="s2">&quot; by </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">predicate</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></pre>
</div>
<div class="m-py-exec">
<pre class="m-code m-nopad m-console">Selected 76 atoms from 76 residues by AtomPredicate
Selected  1 atoms from  1 residues by AtomPredicate
Selected 12 atoms from  3 residues by AtomPredicate
Selected 25 atoms from  6 residues by ResiduePredicate</pre>
</div>
</div>
</section>
<section id="span-vs-selection">
<h3>Span vs Selection</h3>
<p>There are two slightly different types of &quot;selections&quot; in the library.
A <code>Span</code> is a continuous selections of elements, while <code>Selection</code> is an arbitrary set of elements.
Those two forms of selections functionally almost the same so you won't notice any difference for most of the time.
For more details check API reference.</p>
<p>On this page I make no distinction between two.</p>
<div class="m-code-figure">
<div class="m-py-exec">
<pre class="m-code"><span class="nb">print</span><span class="p">(</span><span class="n">frame</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="mi">10</span><span class="p">:</span><span class="mi">20</span><span class="p">])</span>   <span class="c1"># AtomSpan</span>
<span class="nb">print</span><span class="p">(</span><span class="n">frame</span><span class="o">.</span><span class="n">atoms</span><span class="p">[</span><span class="mi">10</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mi">2</span><span class="p">])</span> <span class="c1"># AtomSelection</span></pre>
</div>
<div class="m-py-exec">
<pre class="m-code m-nopad m-console">AtomSpan&lt;size=10, atoms=[A.GLN-2.C, A.GLN-2.O, ... , A.ILE-3.C]&gt;
AtomSelection&lt;size=5, atoms=[A.GLN-2.C, A.GLN-2.CB, ... , A.ILE-3.CA]&gt;</pre>
</div>
</div>
</section>
</section>
<section id="trajectory">
<h2>Trajectory</h2>
<p>A trajectory represents an evolution of <a class="m-doc" href="pyxmolpp2.Frame.html">Frame</a> in time. It needs a reference topology provided by initial <a class="m-doc" href="pyxmolpp2.Frame.html">Frame</a> and
number of input coordinate files.</p>
<p>Let's construct out trajectory from trjtool <code>.dat</code> files (<a class="m-doc" href="pyxmolpp2.TrjtoolDatFile.html">TrjtoolDatFile</a>)</p>
<div class="m-code-figure">
<div class="m-py-exec">
<pre class="m-code"><span class="n">traj</span> <span class="o">=</span> <span class="n">Trajectory</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
    <span class="n">traj</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">TrjtoolDatFile</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">path_to_traj</span><span class="si">}</span><span class="s2">/run</span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s2">05d</span><span class="si">}</span><span class="s2">.dat&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">size</span><span class="p">)</span></pre>
</div>
<div class="m-py-exec">
<pre class="m-code m-nopad m-console">2000</pre>
</div>
</div>
<p>Trajectory supports index access and slices:</p>
<div class="m-code-figure">
<div class="m-py-exec">
<pre class="m-code"><span class="n">frame_10</span> <span class="o">=</span> <span class="n">traj</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="c1"># returns copy of frame</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">traj</span><span class="p">[:</span><span class="mi">100</span><span class="p">]))</span></pre>
</div>
<div class="m-py-exec">
<pre class="m-code m-nopad m-console">100</pre>
</div>
</div>
<p>On iteration over trajectory (or its slice) a copy of frame is created at the beginning and updated on every step.</p>
<div class="m-code-figure">
<div class="m-py-exec">
<pre class="m-code"><span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">traj</span><span class="p">[::</span><span class="mi">250</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">f</span><span class="o">.</span><span class="n">index</span><span class="si">:</span><span class="s2">4d</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">coords</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span></pre>
</div>
<div class="m-py-exec">
<pre class="m-code m-nopad m-console">   0 [8.422286, 0.967190, -13.856332]
 250 [8.376922, 3.669990, -14.561570]
 500 [8.682104, 0.146340, -14.947389]
 750 [6.279336, -0.708019, -14.059577]
1000 [4.111807, -3.405752, -12.400884]
1250 [5.216313, 0.451141, -11.900974]
1500 [5.455517, 0.589096, -12.383871]
1750 [3.487516, 2.592378, -11.418070]</pre>
</div>
</div>
<p>Trajectory does not support simultaneous iterations and keeps track of iterators created.
To re-enter trajectory it's required to release all references to iteration variable from previous run.</p>
<div class="m-code-figure">
<div class="m-py-exec">
<pre class="m-inverted m-code"><span class="hll"><span class="k">del</span> <span class="n">f</span>  <span class="c1"># release trajectory iterator reference</span>
</span><span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">traj</span><span class="p">[::</span><span class="mi">500</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">f</span><span class="o">.</span><span class="n">index</span><span class="si">:</span><span class="s2">4d</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">coords</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span></pre>
</div>
<div class="m-py-exec">
<pre class="m-inverted m-code m-nopad m-console">   0 [8.422286, 0.967190, -13.856332]
 500 [8.682104, 0.146340, -14.947389]
1000 [4.111807, -3.405752, -12.400884]
1500 [5.455517, 0.589096, -12.383871]</pre>
</div>
</div>
<p>If you forget to do so an exception will be raised.</p>
<div class="m-code-figure">
<div class="m-py-exec">
<pre class="m-code"><span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">traj</span><span class="p">[::</span><span class="mi">500</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">coords</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span></pre>
</div>
<div class="m-py-exec">
<pre class="m-code m-nopad m-console"><span class="g g-AnsiRed">Traceback (most recent call last):</span>
<span class="g g-AnsiRed">  File &quot;&lt;string&gt;&quot;, line 1, in &lt;module&gt;</span>
<span class="g g-AnsiRed">pyxmolpp2._core.TrajectoryDoubleTraverseError</span></pre>
</div>
</div>
<aside class="m-note m-warning">
Note that index-based access to trajectory counts as a 1-size iteration.</aside>
<section id="pipe-processing">
<h3>Pipe-processing</h3>
<p>Common pre-processing operations are available in <a class="m-doc" href="pyxmolpp2.pipe.html">pyxmolpp2.pipe</a>.
For example, we often need all frames in trajectory to be aligned by subset of atoms. We can use conveniently pre-processing
trajectory by <a class="m-doc" href="pyxmolpp2.pipe.Align.html">pipe.Align</a>:</p>
<div class="m-code-figure">
<div class="m-py-exec">
<pre class="m-inverted m-code"><span class="kn">from</span> <span class="nn">pyxmolpp2.pipe</span> <span class="kn">import</span> <span class="n">Align</span>

<span class="hll"><span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">traj</span><span class="p">[::</span><span class="mi">500</span><span class="p">]</span> <span class="o">|</span> <span class="n">Align</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="n">aName</span><span class="o">==</span><span class="s2">&quot;CA&quot;</span><span class="p">):</span>
</span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">f</span><span class="o">.</span><span class="n">index</span><span class="si">:</span><span class="s2">4d</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">coords</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span></pre>
</div>
<div class="m-py-exec">
<pre class="m-inverted m-code m-nopad m-console">   0 [8.422286, 0.967190, -13.856332]
 500 [8.485478, 0.972509, -13.941023]
1000 [8.460522, 1.033323, -13.832233]
1500 [8.423310, 1.009532, -13.917922]</pre>
</div>
</div>
<p>Such &quot;pipe&quot; processors can be chained together which makes this scheme very flexible.</p>
</section>
</section>
      </div>
    </div>
  </div>
</article></main>
<div class="m-doc-search" id="search">
  <a href="#!" onclick="return hideSearch()"></a>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-m-8 m-push-m-2">
        <div class="m-doc-search-header m-text m-small">
          <div><span class="m-label m-default">Tab</span> / <span class="m-label m-default">T</span> to search, <span class="m-label m-default">Esc</span> to close</div>
          <div id="search-symbolcount">&hellip;</div>
        </div>
        <div class="m-doc-search-content">
          <form>
            <input type="search" name="q" id="search-input" placeholder="Loading &hellip;" disabled="disabled" autofocus="autofocus" autocomplete="off" spellcheck="false" />
          </form>
          <noscript class="m-text m-danger m-text-center">Unlike everything else in the docs, the search functionality <em>requires</em> JavaScript.</noscript>
          <div id="search-help" class="m-text m-dim m-text-center">
            <p class="m-noindent">Search for modules, classes, functions and other
            symbols. You can omit any prefix from the symbol path; adding a <code>.</code>
            suffix lists all members of given symbol.</p>
            <p class="m-noindent">Use <span class="m-label m-dim">&darr;</span>
            / <span class="m-label m-dim">&uarr;</span> to navigate through the list,
            <span class="m-label m-dim">Enter</span> to go.
            <span class="m-label m-dim">Tab</span> autocompletes common prefix, you can
            copy a link to the result using <span class="m-label m-dim">⌘</span>
            <span class="m-label m-dim">L</span> while <span class="m-label m-dim">⌘</span>
            <span class="m-label m-dim">M</span> produces a Markdown link.</p>
          </div>
          <div id="search-notfound" class="m-text m-warning m-text-center">Sorry, nothing was found.</div>
          <ul id="search-results"></ul>
        </div>
      </div>
    </div>
  </div>
</div>
<script src="search-v1.js"></script>
<script src="searchdata-v1.js" async="async"></script>
<footer><nav>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <p>xmolpp2 Python API. Created with <a href="https://mcss.mosra.cz/documentation/python/">m.css Python doc generator</a>.</p>
      </div>
    </div>
  </div>
</nav></footer>
</body>
</html>
